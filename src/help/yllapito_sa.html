<!DOCTYPE html>
<html lang="fi" data-ng-app="justusApp" data-ng-controller="YllapitoController">
<head>
    <!-- bootstrap :: the  first 3 must be first -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
    <!-- script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-route.min.js"></script -->
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-sanitize.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-animate.min.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-select/0.19.4/select.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/angular-ui-select/0.19.4/select.min.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.1.3/ui-bootstrap-tpls.min.js"></script>

    <!-- script src="js/config.js"></script -->
    <script src="js/generic.js"></script>
    <!-- script src="js/i18n.js"></script -->
    <!-- script src="js/justus.app.js"></script -->
    <script>
    let justushost = 'demo.justus.csc.fi';
    let apiuri = 'https://'+justushost+'/api/justus_save.php/';
    let justusApp = angular.module('justusApp',
    ['ui.select', 'ngAnimate', 'ngSanitize', 'ui.bootstrap']
    );
    </script>
    <script src="js/api.service.js"></script>
    <script src="js/yllapito.controller.js"></script>

    <link rel="stylesheet" href="css/justus.css">
    <style>
    div.striped:nth-of-type(odd) {
      background: #eeeef0;
      padding-bottom: 8px;
    }
    div.striped:nth-of-type(even) {
      background: #dddde0;
      padding-bottom: 8px;
    }
    input {
      font-size: smaller;
      width: auto;
      border: 1px solid gray;
      padding: 0px;
      margin: 0px;
      background: #efefef;
    }
    </style>

    <title>JUSTUS ylläpito</title>
</head>
<body class="container-fluid">

  <div class="row">
    <div class="col-xs-6">
      <ui-select theme="bootstrap" data-ng-model="meta.tables.selected.name" on-select="useTaulu($select.selected.name)">
        <ui-select-match class="ui-select-match" placeholder="">
          <b>{{ $select.selected.name }}</b>
        </ui-select-match>
        <ui-select-choices repeat="(name,o) in meta.tables | filter: $select.search">
          {{o.name}}
        </ui-select-choices>
      </ui-select>
    </div>
    <div class="col-xs-6 text-right">
      <i class="fa fa-refresh" aria-hidden="true" data-ng-model="btnget" data-ng-click="useHae()" title="päivitä"></i>
    </div>
  </div>

  <div class="row striped" data-ng-repeat="d in data | orderBy:'id' track by d.id">
    <div class="col-xs-1">
      id: {{d.id}}<br>
      <button class="fa fa-floppy-o" aria-hidden="true" data-ng-click="usePaivita(d[table.pkcol],table.pkcol)" title="tallenna"></button>
      <button class="fa fa-trash-o" aria-hidden="true" data-ng-click="usePoista(d[table.pkcol])" title="poista"></button>
    </div>
    <div class="col-xs-11">
      <span data-ng-repeat="c in table.columns" data-ng-if="c.name!='id'">
        <span data-ng-bind="c.name">:</span>
        <span data-ng-if="c.name==table.pkcol" data-ng-bind="d[c.name]"></span>
        <input type="text" size="{{d[c.name].length}}" name="{{c.name}}" data-ng-model="d[c.name]" data-ng-if="c.name!=table.pkcol">
      </span>
    </div>
  </div>
  <form name="myformuusi">
    <div class="row">
      <div class="col-xs-1">
          <button class="fa fa-floppy-o" aria-hidden="true" data-ng-click="useLisaa()" title="Lisää data"></button>
      </div>
      <div class="col-xs-11">
        <!-- input type="hidden" data-ng-model="hideme" data-ng-init="dnew.hideme=true" -->
        <span data-ng-repeat="c in table.columns" data-ng-if="c.name!=table.pkcol">
          {{c.name}}:&nbsp;<input type="text" class="input-sm" data-ng-model="dnew[c.name]">
        </span>
      </div>
    </div>
  </form>

  <div class="row">
    <div class="col-xs-12">
  <pre>
  table: {{table}}
  rawdata: {{rawdata}}
  data: {{data}}
  dnew: {{dnew}}
  meta: {{meta}}
  </pre>
    </div>
  </div>

</body>
</html>
